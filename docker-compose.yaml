version: '3'
services:
    php-fpm:
        build: docker/php-fpm
        expose:
            - '9000'
        depends_on:
            - postgres
        volumes:
            - ./:/var/www/html:rw

    nginx:
        build: docker/nginx
        ports:
            - '${APP_HTTP_PORT}:80'
            - '${APP_HTTPS_PORT}:443'
        depends_on:
            - php-fpm
        volumes:
            - ./:/var/www/html:rw

    postgres:
        image: postgres:10.0-alpine
        environment:
            - POSTGRES_USER=${DATABASE_USER}
            - POSTGRES_PASSWORD=${DATABASE_PASSWORD}
            - POSTGRES_DB=${DATABASE_NAME}
        ports:
            - '${DATABASE_PORT}:5432'

    adminer:
        image: adminer:4.7.1-standalone
        restart: always
        ports:
            - '8080:8080'
        environment:
            - 'ADMINER_DESIGN=pappu687'
